<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <title>Case Control Matching</title>
  <style type="text/css">

  <!-- 

  H1 {font-weight:bold; color:#006699; font-size:125%; }
  H2 {font-weight:bold; color:#006699; font-size:110%; }
  TABLE {font-size:100%;}

  /* paragraph tags */
  .step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
  .menuselection {margin-left:10px}
  .bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
  .codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px;}

  /* inline tags */
  .screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
  .name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
  .runinhead {font-weight: bold} 
  .superscript {vertical-align:super; font-size:80%}
  .subscript {vertical-align:sub; font-size:80%}


  --> 
  </style>
</head>

<body>
  <p>This procedure matches cases (demanders) and controls (suppliers)
  contained in a single dataset. Matching is based on approximate
  or exact equality of one or more match variables.</p>

  <p>For each case in the demander or case group, a match is
  attempted with cases in the supplier or control group. The id of
  the selected supplier case or cases if multiple matches are
  requested is written as one or more new variables.</p>

  <p><span class="runinhead">Variables to Match on</span> Select
  one or more variables to match on. The dataset does not need to
  be sorted by these variables.</p>

  <p><span class="runinhead">Match Tolerances</span> If the match
  variables for demander and supplier cases must be exactly equal,
  leave this control empty. If some tolerance or "fuzz" is desired,
  enter the tolerance value for each matching variables. Use zero
  for an exact match. There must be as many values entered,
  separated by a space, as there are match variables.</p>

  <p class="bullet">• String variables must have a tolerance value
  of zero.</p>

  <p><span class="runinhead">Group Indicator</span> Specify the
  variable that distinguishes demander and supplier cases. A value
  of 1 indicates a demander case, and a value of 0 indicates a
  supplier. Any other values, including missing, will cause the
  case to be ignored.</p>

  <p><span class="runinhead">Case ID</span> Specify a case
  identifier variable. The Case id value for the selected
  supplier(s) will be stored with each demander case.</p>

  <p><span class="runinhead">Names for Match ID Variables</span>
  Specify a name for the variable that will hold the id of the
  selected supplier case. Multiple names can be entered, separated
  by a blank. The number of supplier cases for each demander is
  determined by the number of variable names entered here. If a
  match cannot be produced, the value will be system missing.</p>

  <p class="bullet">• The variable names listed must not already
  exist in the dataset.</p>

  <p><span class="runinhead">Name for Matchgroup Variable</span>
  Enter a name for the match group variable. This variable will
  hold a code indicating the set of eligible supplier cases. The
  value itself is not meaningful, but two cases with the same value
  have the same set of eligible supplier cases.</p>

  <p class="bullet">• The variable name listed must not already
  exist in the dataset.</p>

  <h2>Options</h2>

  <p><span class="runinhead">Variable for Number of Eligible
  Cases</span> Optionally, enter a variable name to record the size
  of the pool, i.e., the number of eligible cases, for each
  demander case. This is the number of cases that meet the matching
  criteria after matches for previous cases have been removed, if
  sampling without replacement.</p>

  <p class="bullet">• The variable name listed must not already
  exist in the dataset.</p>

  <p><span class="runinhead">Sampling</span> Supplier cases can be
  drawn with or without replacement. Indicate the desired
  choice.</p>

  <p><span class="runinhead">Give priority to exact matches</span>
  Check this box to cause the matching algorithm to try first for
  an exact match before trying for a fuzzy match.</p>

  <p><span class="runinhead">Maximize execution performance</span>
  Check this box to maximize the execution performance - greatest
  speed and least memory usage. Checking this may slightly increase
  the number of unmatched cases, but for large datasets the
  performance improvement can be dramatic. Some of the output
  statistics do not apply, because the procedure does not
  accumulate data on all possible matches.</p>

  <p class="bullet">• You cannot specify both exact priority and
  minimize memory.</p>

  <p><span class="runinhead">Randomize case order when drawing
  matches</span> Check this to draw matches for the demander cases
  in random order. Otherwise, the demander cases are processed in
  the order in which they occur in the file. This could result in
  fewer cases to select from later in the file. If the demander
  cases have a systematic order, this could introduce some
  bias.</p>

  <p><span class="runinhead">Random Number Seed</span> If you want
  to be able to reproduce the matches exactly on a future run with
  the same data, you can set a seed value for the random numbers
  used when picking from a set at random. This seed is not related
  to the general SPSS Statistics random number seed.</p>

  <h2>Additional Output</h2>

  <p><span class="runinhead">Additional Output Dataset</span> Check
  the box and enter a dataset name in order to create a new dataset
  containing the matches. The new dataset will contain all the
  variables for each supplier case that was assigned to a demander
  case followed by the matchgroup variable and the id of the
  demander case to which it was assigned.</p>

  <p class="bullet">• If you use this option, only one supplier
  case can be assigned to each demander case. That is, the Names
  for Match ID Variables field on the main dialog can contain only
  one name.</p>

  <h2>Additional Features</h2>

  <p>This dialog generates syntax for the FUZZY extension command.
  To display syntax help for this command, run the following
  syntax:</p>

  <p class="codeblock">FUZZY /HELP.</p>

  <p>FUZZY has a number of features not supported in this dialog,
  including using separate case and control datasets as input.
  Custom functions written in Python can also be used for
  calculating the fuzzy distance. In syntax you can create a log
  file that records progress as the procedure runs. This can be
  very helpful in large problems.</p>

  <h2>Requirements</h2>This command requires the Python Essentials
  and at least version 18 of IBM SPSS Statistics. For single
  dataset usage, Statistics version 21 or a hot fix for version 20
  may be required. You can download the Python Essentials from the
  SPSS Community website at
  www.ibm.com/developerworks/spssdevcentral.<br>
  <hr>

  <p style="font-size:80%;">
  © Copyright IBM Corp. 1989, 2013</p>
</body>
</html>
